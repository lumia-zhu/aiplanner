# ä»»åŠ¡æ ‡ç­¾ç³»ç»Ÿæ•°æ®åº“è¿ç§»æŒ‡å—

## ğŸ“‹ åŠŸèƒ½è¯´æ˜

ä¸ºä»»åŠ¡ç®¡ç†ç³»ç»Ÿæ·»åŠ æ ‡ç­¾åŠŸèƒ½,æ”¯æŒ:
- âœ… é¢„è®¾æ ‡ç­¾(ç®€å•ã€å›°éš¾ã€é‡è¦ã€ç´§æ€¥)
- âœ… ç”¨æˆ·è‡ªå®šä¹‰æ ‡ç­¾
- âœ… æ¯ä¸ªä»»åŠ¡æœ€å¤š3ä¸ªæ ‡ç­¾
- âœ… ç”¨æˆ·æœ€å¤šä¿å­˜20ä¸ªè‡ªå®šä¹‰æ ‡ç­¾
- âœ… å®Œå…¨å‘åå…¼å®¹ç°æœ‰æ•°æ®

## ğŸ—„ï¸ æ•°æ®åº“å˜æ›´

### 1. tasks è¡¨
```sql
-- æ–°å¢å­—æ®µ
tags TEXT[] DEFAULT '{}'

-- æ–°å¢ç´¢å¼•
CREATE INDEX idx_tasks_tags ON tasks USING GIN(tags)
```

### 2. user_profiles è¡¨
```sql
-- æ–°å¢å­—æ®µ
custom_task_tags TEXT[] DEFAULT '{}'
```

## ğŸ“ è¿ç§»æ­¥éª¤

### æ–¹å¼ä¸€: é€šè¿‡ Supabase Dashboard (æ¨è)

1. ç™»å½• Supabase Dashboard
2. è¿›å…¥ä½ çš„é¡¹ç›®
3. ç‚¹å‡»å·¦ä¾§ **SQL Editor**
4. ç‚¹å‡» **New query**
5. å¤åˆ¶ `add-task-tags.sql` çš„å…¨éƒ¨å†…å®¹
6. ç‚¹å‡» **Run** æ‰§è¡Œ
7. æŸ¥çœ‹æ‰§è¡Œç»“æœ,ç¡®è®¤æ˜¾ç¤º âœ… æˆåŠŸæ¶ˆæ¯

### æ–¹å¼äºŒ: é€šè¿‡å‘½ä»¤è¡Œ

```bash
# è¿›å…¥ database ç›®å½•
cd task-manager/database

# ä½¿ç”¨ psql æ‰§è¡Œè¿ç§»
psql -h <your-supabase-host> \
     -U postgres \
     -d postgres \
     -f add-task-tags.sql
```

## âœ… éªŒè¯è¿ç§»

æ‰§è¡Œååº”è¯¥çœ‹åˆ°:

```
NOTICE:  âœ… tasks.tags å­—æ®µæ·»åŠ æˆåŠŸ
NOTICE:  âœ… user_profiles.custom_task_tags å­—æ®µæ·»åŠ æˆåŠŸ
NOTICE:  ğŸ‰ æ•°æ®åº“è¿ç§»å®Œæˆ!æ‰€æœ‰ç°æœ‰æ•°æ®ä¿æŒä¸å˜ã€‚

 metric     | count
------------+-------
 ç°æœ‰ä»»åŠ¡æ•° |   X
 ç°æœ‰ç”¨æˆ·æ•° |   Y
```

## ğŸ”™ å›æ»šæ–¹æ¡ˆ

å¦‚æœéœ€è¦å›æ»š,æ‰§è¡Œ `rollback-task-tags.sql`:

```sql
-- åˆ é™¤æ‰€æœ‰æ ‡ç­¾ç›¸å…³å­—æ®µå’Œç´¢å¼•
-- âš ï¸ è­¦å‘Š: ä¼šåˆ é™¤æ‰€æœ‰æ ‡ç­¾æ•°æ®!
```

## ğŸ“Š æ•°æ®ç¤ºä¾‹

### ä»»åŠ¡æ ‡ç­¾ç¤ºä¾‹
```sql
-- æ›´æ–°ä»»åŠ¡,æ·»åŠ æ ‡ç­¾
UPDATE tasks 
SET tags = '{"important", "urgent"}' 
WHERE id = 'xxx';

-- æŸ¥è¯¢å¸¦æœ‰ç‰¹å®šæ ‡ç­¾çš„ä»»åŠ¡
SELECT * FROM tasks 
WHERE 'important' = ANY(tags);
```

### ç”¨æˆ·è‡ªå®šä¹‰æ ‡ç­¾ç¤ºä¾‹
```sql
-- æ›´æ–°ç”¨æˆ·çš„è‡ªå®šä¹‰æ ‡ç­¾æ± 
UPDATE user_profiles 
SET custom_task_tags = '{"å­¦ä¹ ", "å·¥ä½œ", "ä¸ªäºº"}' 
WHERE user_id = 'xxx';
```

## ğŸ” å¸¸è§é—®é¢˜

### Q: è¿ç§»ä¼šå½±å“ç°æœ‰ä»»åŠ¡å—?
A: ä¸ä¼š!æ‰€æœ‰ç°æœ‰ä»»åŠ¡ä¼šè‡ªåŠ¨è·å¾—ç©ºæ•°ç»„ `[]`,æ˜¾ç¤ºå’ŒåŠŸèƒ½å®Œå…¨æ­£å¸¸ã€‚

### Q: å¦‚æœç”¨æˆ·æ²¡æœ‰ user_profiles è®°å½•æ€ä¹ˆåŠ?
A: åˆ›å»ºä»»åŠ¡æ—¶æ ‡ç­¾åŠŸèƒ½ä»ç„¶å¯ç”¨,åªæ˜¯è‡ªå®šä¹‰æ ‡ç­¾ä¸ä¼šè¢«ä¿å­˜åˆ°æ ‡ç­¾æ± ã€‚

### Q: æ ‡ç­¾å¯ä»¥ä¸ºç©ºå—?
A: å¯ä»¥!æ ‡ç­¾æ˜¯å®Œå…¨å¯é€‰çš„,ç”¨æˆ·å¯ä»¥ä¸æ·»åŠ ä»»ä½•æ ‡ç­¾ã€‚

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜,è¯·æŸ¥çœ‹:
- Supabase æ—¥å¿—: Dashboard > Logs
- è¡¨ç»“æ„: Dashboard > Table Editor
- SQL æŸ¥è¯¢: Dashboard > SQL Editor










